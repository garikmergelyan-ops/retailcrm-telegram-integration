# üîß –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥–µ

### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ accountUrl**
- **–ü—Ä–æ–±–ª–µ–º–∞**: `accountUrl` –∏–∑ query –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ç–µ—Ä—è–ª—Å—è –∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–ª—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
- **–†–µ—à–µ–Ω–∏–µ**: –¢–µ–ø–µ—Ä—å `accountUrl` –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏–∑ query –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è

### 2. **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `site`**
- **–ü—Ä–æ–±–ª–µ–º–∞**: API –≤–æ–∑–≤—Ä–∞—â–∞–ª –æ—à–∏–±–∫—É 403 –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∞–π—Ç–æ–≤
- **–†–µ—à–µ–Ω–∏–µ**: 
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ø–æ–ª—É—á–µ–Ω–∏—è site –∫–æ–¥–∞ (3 —Ä–∞–∑–Ω—ã—Ö API endpoint)
  - –î–æ–±–∞–≤–ª–µ–Ω fallback –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ site –∫–æ–¥—ã: `default`, `main`, `store`, `shop`, `site1`, `site`
  - –ö–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–±—É–µ—Ç –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã, –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ—Ç —Ä–∞–±–æ—á–∏–π

### 3. **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ 403 –æ—à–∏–±–æ–∫ (–Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ API endpoint)
- –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –≤–∞—à–µ–π —Å—Ç–æ—Ä–æ–Ω–µ

### ‚úÖ 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á–∏ –Ω–∞ Render.com

**–ó–∞–π–¥–∏—Ç–µ –≤ Render.com Dashboard:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Å–µ—Ä–≤–∏—Å
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Environment** (–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Å–ª–µ–¥—É—é—â–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:**

```
RETAILCRM_URL_3=https://slimteapro-store.retailcrm.ru
RETAILCRM_API_KEY_3=–≤–∞—à_–∫–ª—é—á_–¥–ª—è_–∞–∫–∫–∞—É–Ω—Ç–∞_3
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** 
- API –∫–ª—é—á –¥–ª—è Account 3 –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
- –ï—Å–ª–∏ –∫–ª—é—á –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ `/api/v5/reference/sites`, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - –∫–æ–¥ –ø–æ–ø—Ä–æ–±—É–µ—Ç –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã

### ‚úÖ 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç—Ä–∏–≥–≥–µ—Ä–∞ –≤ RetailCRM

**–î–ª—è Account 3 (SlimTeaPro):**

1. –ó–∞–π–¥–∏—Ç–µ –≤ RetailCRM: `https://slimteapro-store.retailcrm.ru`
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** ‚Üí **–¢—Ä–∏–≥–≥–µ—Ä—ã**
3. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Ç—Ä–∏–≥–≥–µ—Ä –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Ä–∞–∑–¥–µ–ª–µ "Send parameters":**

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `order_id` = `{{order.id}}`
- `order_number` = `{{order.number}}`
- `status` = `{{order.status}}`
- `account_url` = `https://slimteapro-store.retailcrm.ru` ‚ö†Ô∏è **–í–ê–ñ–ù–û!**

**–ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `account_url` –Ω–µ—Ç:**
1. –ù–∞–∂–º–∏—Ç–µ **"Add parameter"**
2. **Parameter name**: `account_url`
3. **Parameter value**: `https://slimteapro-store.retailcrm.ru`
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä

### ‚úÖ 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á –≤ RetailCRM

**–î–ª—è Account 3:**

1. –ó–∞–π–¥–∏—Ç–µ –≤ RetailCRM: `https://slimteapro-store.retailcrm.ru`
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** ‚Üí **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** ‚Üí **API –¥–æ—Å—Ç—É–ø**
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ API –∫–ª—é—á –∞–∫—Ç–∏–≤–µ–Ω –∏ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞:
   - ‚úÖ –ß—Ç–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
   - ‚úÖ –ß—Ç–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

4. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ API –∫–ª—é—á** –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ —Å —Ç–µ–º, —á—Ç–æ –≤ Render.com

### ‚úÖ 4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ Render.com –∑–∞–¥–µ–ø–ª–æ–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑** –≤ RetailCRM (Account 3)
2. **–ê–ø–ø—Ä—É–≤—å—Ç–µ –µ–≥–æ** (–∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç–∞—Ç—É—Å –Ω–∞ "approved")
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ Render.com:**
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `‚úÖ Account URL determined from query: https://slimteapro-store.retailcrm.ru`
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `üîë Using API key for: https://slimteapro-store.retailcrm.ru`
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `‚úÖ API Response received` (—Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∑–∞–∫–∞–∑–∞)
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `Order structure: { hasCustomer: true, hasItems: true, ... }`

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram** - –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ –ø–æ–ª–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –¥–∞–Ω–Ω—ã–º–∏ –∑–∞–∫–∞–∑–∞

## üîç –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–±–ª–µ–º–∞: API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 403 –æ—à–∏–±–∫—É

**–†–µ—à–µ–Ω–∏–µ:**
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å–ª–∏ API –∫–ª—é—á –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ `/api/v5/reference/sites`
- –ö–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø—Ä–æ–±—É–µ—Ç –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ site –∫–æ–¥—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: `üîÑ Trying with site parameter: default` (–∏–ª–∏ –¥—Ä—É–≥–æ–π –∫–æ–¥)

### –ü—Ä–æ–±–ª–µ–º–∞: –í—Å–µ –µ—â–µ "Not specified" –≤ Telegram

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: `Order structure: { hasCustomer: true, hasItems: true }`
2. –ï—Å–ª–∏ `hasCustomer: false` –∏–ª–∏ `hasItems: false` - –∑–Ω–∞—á–∏—Ç API –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ
3. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞
   - –ü—Ä–∞–≤–∞ API –∫–ª—é—á–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
   - –°—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∑–∞–∫–∞–∑ —Å —Ç–∞–∫–∏–º ID –≤ RetailCRM

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π account URL –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ç—Ä–∏–≥–≥–µ—Ä–µ –¥–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `account_url` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: `‚úÖ Account URL determined from query: https://slimteapro-store.retailcrm.ru`

## üìû –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å

–ü—Ä–∏—à–ª–∏—Ç–µ –ª–æ–≥–∏ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∏ —è –ø–æ–º–æ–≥—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è!

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –∑–∞–¥–µ–ø–ª–æ–µ–Ω—ã
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç—Ä–∏–≥–≥–µ—Ä–∞, –∑–∞—Ç–µ–º –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ

